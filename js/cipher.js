NS=new Class({initialize:function(a,b){this.myexec=a;this.stack=[];this.result={};this.next="next";this.firstRun=true;this.Context=new Class({initialize:function(){this.step=0;this.steps=[]},insertStep:function(c){this.steps.splice(this.step++,0,c)},getStep:function(){if(this.step>=this.steps.length){return null}return this.steps[this.step++]}});this.currentContext=new this.Context();if(b){window.CONTINUE=this.CONTINUE.bind(this);window.DONE=this.DONE.bind(this);window.AGAIN=this.AGAIN.bind(this);window.DO=this.DO.bind(this);window.STEP=this.STEP.bind(this);window.SET=this.SET.bind(this);window.EXIT=0}this.timerid},ticker:function(){var b;var c=true;do{if((b=this.currentContext.getStep())===null){c=this.poplevel()}else{switch(b.type){case"f":var a=this.currentContext.step;c=false;this.next="next";b.data(this.result);switch(this.next){case"continue":this.currentContext.step=a-1;break;case"again":this.currentContext.step=0;break;case"done":this.poplevel();break;case"next":default:}break;case"do":this.stack.push(this.currentContext);this.scope=null;this.currentContext=b.data;break;case"loop":this.currentContext.step=0;break;case"exit":c=this.poplevel();break;case"fail":default:this.throwerror(b.data)}}}while(c)},poplevel:function(){if(this.stack.length>0){this.currentContext=this.stack.pop();return true}else{$clear(this.timerid);this.whendone(true,this.result);return false}}.protect(),throwerror:function(a){$clear(this.timerid);this.whendone(false,a);throw"NS terminating"}.protect(),step:function(b){var a;switch($type(b)){case"function":a=b.bind(this);this.currentContext.insertStep({type:"f",data:a,firstRun:true});break;case"array":this.donest(b);break;case"number":if(b==EXIT){this.currentContext.insertStep({type:"exit"});break}default:this.currentContext.insertStep({type:"exit"})}return this},STEP:function(a){this.step(a);this.currentContext.step--},donest:function(b){var a;this.stack.push(this.currentContext);a=new this.Context();this.currentContext=a;b.each(function(c){this.step(c)}.bind(this));this.currentContext.insertStep({type:"loop"});this.currentContext.step=0;this.currentContext=this.stack.pop();this.currentContext.insertStep({type:"do",data:a});return this},DO:function(b){var a;this.stack.push(this.currentContext);a=new this.Context();this.currentContext=a;b.each(function(c){this.step(c)}.bind(this));this.currentContext.insertStep({type:"loop"});this.currentContext.step=0},CONTINUE:function(a){if($type(a)){this.result=a}this.next="continue";return this},AGAIN:function(a){if($type(a)){this.result=a}this.next="again";return this},DONE:function(a){if($type(a)){this.result=a}this.next="done";return this},SET:function(a){this.result=a},EXEC:function(c,b){var a=this.myexec.bind(this);this.whendone=b;a(c);this.currentContext.step=0;this.timerid=this.ticker.periodical(1,this)}});(function(P){var u=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9","+","/"];function B(ai){var aa=ai.length;var ah=Math.floor(aa/3);var ab=aa-3*ah;var aj="";var ag=0;for(var ac=0;ac<ah;ac++){var af=ai[ag++]&255;var ae=ai[ag++]&255;var ad=ai[ag++]&255;aj+=(u[af>>2]);aj+=(u[(af<<4)&63|(ae>>4)]);aj+=(u[(ae<<2)&63|(ad>>6)]);aj+=(u[ad&63])}if(ab==0){}else{if(ab==1){var af=ai[ag++]&255;aj+=(u[af>>2]);aj+=(u[(af<<4)&63]);aj+=("==")}else{if(ab==2){var af=ai[ag++]&255;var ae=ai[ag++]&255;aj+=(u[af>>2]);aj+=(u[(af<<4)&63|(ae>>4)]);aj+=(u[(ae<<2)&63]);aj+=("=")}else{throw"never happen"}}}return aj}var q=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];function Y(ab){var aa=(0<=ab)&&(ab<q.length)?q[ab]:-1;if(aa<0){throw"Illegal character "+ab}return aa}function w(al){var aa=al.length;var ak=Math.floor(aa/4);if(4*ak!=aa){throw"String length must be a multiple of four."}var af=0;if(aa!=0){if(al.charAt(aa-1)=="="){af++;ak--}if(al.charAt(aa-2)=="="){af++}}var ai=(3*ak-af);if(ai<0){ai=0}var am=new Array(ai);var ah=0;var aj=0;for(var ae=0;ae<ak;ae++){var ag=Y(al.charCodeAt(ah++));var ad=Y(al.charCodeAt(ah++));var ac=Y(al.charCodeAt(ah++));var ab=Y(al.charCodeAt(ah++));am[aj++]=255&((ag<<2)|(ad>>4));am[aj++]=255&((ad<<4)|(ac>>2));am[aj++]=255&((ac<<6)|ab)}if(af==0){}else{if(af==1){var ag=Y(al.charCodeAt(ah++));var ad=Y(al.charCodeAt(ah++));var ac=Y(al.charCodeAt(ah++));am[aj++]=255&((ag<<2)|(ad>>4));am[aj++]=255&((ad<<4)|(ac>>2))}else{if(af==2){var ag=Y(al.charCodeAt(ah++));var ad=Y(al.charCodeAt(ah++));am[aj++]=255&((ag<<2)|(ad>>4))}else{throw"never happen"}}}return am}function F(aa){return K(B(aa))}function D(aa){return w(I(aa))}var i={};i.x="xx";i["+"]="xa";i["/"]="xb";i["="]="";function K(ac){var ab="";for(var aa=0;aa<ac.length;aa++){var ae=ac.charAt(aa);var ad=i[ae];if(ad!=null){ab=ab+ad}else{ab=ab+ae}}return ab}var e={};e.x="x";e.a="+";e.b="/";function I(ac){var ab="";for(var aa=0;aa<ac.length;aa++){var ae=ac.charAt(aa);if(ae=="x"){ae=ac.charAt(++aa);var ad=e[ae];if(ad!=null){ab=ab+ad}else{}}else{ab=ab+ae}}while(ab.length%4!=0){ab+="="}return ab}function z(ab,aa){if(ab.length!=aa.length){return false}var ad=ab.length;for(var ac=0;ac<ad;ac++){if(ab[ac]!=aa[ac]){return false}}return true}function L(ab){if(ab==null){return"??"}ab&=255;var aa=ab.toString(16);return(aa.length<2)?"0"+aa:aa}function Z(ab,aa,ac){return E(ab,aa,ac)}function E(ad,ac,ae){if(ae==null){ae=""}if(ac==null){ac=256}var aa="";for(var ab=0;ab<ad.length;ab++){if((ab%ac==0)&&(0<ab)){aa+="\n"}aa+=L(ad[ab])+ae}return aa.toUpperCase()}var r={};r["0"]=0;r["1"]=1;r["2"]=2;r["3"]=3;r["4"]=4;r["5"]=5;r["6"]=6;r["7"]=7;r["8"]=8;r["9"]=9;r.A=10;r.B=11;r.C=12;r.D=13;r.E=14;r.F=15;r.a=10;r.b=11;r.c=12;r.d=13;r.e=14;r.f=15;function x(ab){var aa=r[ab];if(aa==null){throw"found an invalid character."}return aa}function A(af){var ab=[];for(var ae=0,ad=0;ae<af.length;ae++){var ag=af.charAt(ae);if(ag=="s"){continue}else{ab[ad++]=ag}}if(ab.length%2!=0){throw"data must be a multiple of two."}var aa=new Array(ab.length>>1);for(var ae=0;ae<ab.length;ae+=2){var ac=255&((x(ab[ae])<<4)|(x(ab[ae+1])));aa[ae>>1]=ac}return aa}var H=128;var J=192;var j=224;var W=240;var p=248;var l=252;var T=254;var S=127;var R=63;var o=31;var y=15;var f=7;var m=3;var C=1;function g(ae){var ab=[];var ad=ae.length;var aa=0;for(var ac=0;ac<ad;ac++){var af=ae.charCodeAt(ac);if(af<=127){ab[aa++]=af}else{if(af<=2047){ab[aa++]=J|(o&(af>>>6));ab[aa++]=H|(R&(af>>>0))}else{if(af<=65535){ab[aa++]=j|(y&(af>>>12));ab[aa++]=H|(R&(af>>>6));ab[aa++]=H|(R&(af>>>0))}else{if(af<=1114111){ab[aa++]=W|(f&(af>>>18));ab[aa++]=H|(R&(af>>>12));ab[aa++]=H|(R&(af>>>6));ab[aa++]=H|(R&(af>>>0))}else{throw"error"}}}}}return ab}function V(ad){var aa="";var ac=ad.length;for(var ab=0;ab<ac;){var ae=ad[ab++];if(ae<128){aa+=String.fromCharCode(ae)}else{if((ae<j)){aa+=String.fromCharCode(((o&ae)<<6)|((R&ad[ab++])<<0))}else{if((ae<W)){aa+=String.fromCharCode(((y&ae)<<12)|((R&ad[ab++])<<6)|((R&ad[ab++])<<0))}else{if((ae<p)){aa+=String.fromCharCode(((f&ae)<<18)|((R&ad[ab++])<<12)|((R&ad[ab++])<<6)|((R&ad[ab++])<<0))}else{if((ae<l)){aa+=String.fromCharCode(((m&ae)<<24)|((R&ad[ab++])<<18)|((R&ad[ab++])<<12)|((R&ad[ab++])<<6)|((R&ad[ab++])<<0))}else{if((ae<T)){aa+=String.fromCharCode(((C&ae)<<30)|((R&ad[ab++])<<24)|((R&ad[ab++])<<18)|((R&ad[ab++])<<12)|((R&ad[ab++])<<6)|((R&ad[ab++])<<0))}}}}}}}return aa}function b(ab){var aa="";for(var ac=0;ac<ab.length;ac++){aa+=String.fromCharCode(ab[ac])}return aa}function h(ac){var aa=new Array(ac.length);for(var ab=0;ab<ac.length;ab++){aa[ab]=ac.charCodeAt(ab)}return aa}function c(aa){return[255&(aa>>24),255&(aa>>16),255&(aa>>8),255&(aa>>0)]}function G(aa){return((aa[0]<<24)|(aa[1]<<16)|(aa[2]<<8)|(aa[3]<<0))}function d(aa){return[255&(aa>>8),255&(aa>>0)]}function O(aa){return(0|(aa[0]<<8)|(aa[1]<<0))}function N(aa){return[255&(aa>>0),255&(aa>>8),255&(aa>>16),255&(aa>>24)]}function s(aa){return(0|(aa[3]<<0)|(aa[2]<<8)|(aa[1]<<16)|(aa[0]<<24))}function Q(aa){return[255&(aa>>0),255&(aa>>8)]}function v(aa){return(0|(aa[1]<<0)|(aa[0]<<8))}function k(ab){var ad=ab.length<<2;var ae=new Array(ad);for(var ac=0,aa=0;ac<ab.length&&aa<ae.length;){ae[aa++]=255&(ab[ac]>>24);ae[aa++]=255&(ab[ac]>>16);ae[aa++]=255&(ab[ac]>>8);ae[aa++]=255&(ab[ac]>>0);ac++}return ae}function M(ae){var ad=(ae.length+3)>>2;var ab=new Array(ad);for(var ac=0,aa=0;ac<ab.length&&aa<ae.length;){ab[ac++]=(aa<ae.length?(ae[aa++]<<24):0)|(aa<ae.length?(ae[aa++]<<16):0)|(aa<ae.length?(ae[aa++]<<8):0)|(aa<ae.length?(ae[aa++]):0)}return ab}function X(ab){var ad=ab.length<<2;var ae=new Array(ad);for(var ac=0,aa=0;ac<ab.length&&aa<ae.length;){ae[aa++]=255&(ab[ac]>>0);ae[aa++]=255&(ab[ac]>>8);ae[aa++]=255&(ab[ac]>>16);ae[aa++]=255&(ab[ac]>>24);ac++}return ae}function t(ae){var ad=(ae.length+3)>>2;var ab=new Array(ad);for(var ac=0,aa=0;ac<ab.length&&aa<ae.length;){ab[ac++]=(aa<ae.length?(ae[aa++]):0)|(aa<ae.length?(ae[aa++]<<8):0)|(aa<ae.length?(ae[aa++]<<16):0)|(aa<ae.length?(ae[aa++]<<24):0)}return ab}function a(ac){var ab="";for(var aa=0;aa<ac.length;aa++){var ad=ac.charAt(aa);if(ad=="s"||ad=="\t"||ad=="\r"||ad=="\n"){}else{ab+=ad}}return ab}function U(aa,ab){return function(ah,aj,ak){var ac=true;for(var af=0;af<ah;af++){for(var ae=aj;ae<ak;ae++){var ag=new Array(ae);for(var ad=0;ad<ae;ad++){ag[ad]=Math.floor(Math.random()*256)}var al=aa(ag);var ai=ab(al);trace("in :"+ag.length+":"+E(ag));trace("b64:"+al.length+":"+al);trace("out:"+ai.length+":"+E(ag));if(z(ag,ai)){trace("OK! ( "+af+","+ae+")")}else{trace("ERR ( "+af+","+ae+")");ac=false}trace("-----------")}}if(ac){trace("ALL OK! ")}else{trace("FOUND ERROR!")}}}P.base64_encode=B;P.base64_decode=w;P.base64_test=U(B,w);P.base64x_encode=F;P.base64x_decode=D;P.base64x_test=U(F,D);P.base64x_pre_encode=K;P.base64x_pre_decode=I;P.base16_encode=E;P.base16_decode=A;P.base16=Z;P.hex=Z;P.utf82str=V;P.str2utf8=g;P.str2char=h;P.char2str=b;P.i2ba=c;P.ba2i=G;P.i2ba_be=c;P.ba2i_be=G;P.i2ba_le=N;P.ba2i_le=s;P.s2ba=d;P.ba2s=O;P.s2ba_be=d;P.ba2s_be=O;P.s2ba_le=Q;P.ba2s_le=v;P.ba2ia=M;P.ia2ba=k;P.ia2ba_be=k;P.ba2ia_be=M;P.ia2ba_le=X;P.ba2ia_le=t;P.cmparr=z})(window);(function(e){var h=function(o){var i=function(t,p,q,s,y,u){while(--u>=0){var r=p*this[t++]+q[s]+y;y=Math.floor(r/67108864);q[s++]=r&67108863}return y};var m=function(t,A,B,s,y,p){var v=A&32767,z=A>>15;while(--p>=0){var r=this[t]&32767;var u=this[t++]>>15;var q=z*r+u*v;r=v*r+((q&32767)<<15)+B[s]+(y&1073741823);y=(r>>>30)+(q>>>15)+z*u+(y>>>30);B[s++]=r&1073741823}return y};var l=function(t,A,B,s,y,p){var v=A&16383,z=A>>14;while(--p>=0){var r=this[t]&16383;var u=this[t++]>>14;var q=z*r+u*v;r=v*r+((q&16383)<<14)+B[s]+y;y=(r>>28)+(q>>14)+z*u;B[s++]=r&268435455}return y};var k=244837814094590;var j=((k&16777215)==15715070);if(true){o.prototype.am=m;o.dbits=30;o.log("AM_INIT MODIFICATION SUCCEEDED.")}else{if(j&&(navigator.appName=="Microsoft Internet Explorer")){o.prototype.am=m;o.dbits=30}else{if(j&&(navigator.appName!="Netscape")){o.prototype.am=i;o.dbits=26}else{o.prototype.am=l;o.dbits=28}}}o.BI_FP=52;o.DB=o.dbits;o.DM=(1<<o.DB)-1;o.DV=(1<<o.DB);o.FV=Math.pow(2,o.BI_FP);o.F1=o.BI_FP-o.DB;o.F2=2*o.DB-o.BI_FP};var c=function(i){this.m=i;this.convert=function(j){if(j.s<0||j.compareTo(this.m)>=0){return j.mod(this.m)}else{return j}}};c.prototype.revert=function(i){return i};c.prototype.reduce=function(i){i.divRemTo(this.m,null,i)};c.prototype.mulTo=function(i,k,j){i.multiplyTo(k,j);this.reduce(j)};c.prototype.sqrTo=function(i,j){i.squareTo(j);this.reduce(j)};c.prototype.toString=function(){return"Classic()"};var d=function(i){this.m=i;this.mp=i.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<(g.DB-15))-1;this.mt2=2*i.t};d.prototype.convert=function(i){var j=new g();i.abs().dlShiftTo(this.m.t,j);j.divRemTo(this.m,null,j);if(i.s<0&&j.compareTo(g.ZERO)>0){this.m.subTo(j,j)}return j};d.prototype.revert=function(i){var j=new g();i.copyTo(j);this.reduce(j);return j};d.prototype.reduce=function(k){while(k.t<=this.mt2){k[k.t++]=0}for(var m=0;m<this.m.t;++m){var l=k[m]&32767;var o=(l*this.mpl+(((l*this.mph+(k[m]>>15)*this.mpl)&this.um)<<15))&g.DM;l=m+this.m.t;k[l]+=this.m.am(0,o,k,m,0,this.m.t);while(k[l]>=g.DV){k[l]-=g.DV;l++;k[l]++}}k.clamp();k.drShiftTo(this.m.t,k);if(k.compareTo(this.m)>=0){k.subTo(this.m,k)}};d.prototype.sqrTo=function(i,j){i.squareTo(j);this.reduce(j)};d.prototype.mulTo=function(i,k,j){i.multiplyTo(k,j);this.reduce(j)};d.prototype.toString=function(){return"Montgomery()"};var g=function(){if(arguments.length==0){}else{if(arguments.length==1){var o=arguments[0];var k=typeof o;if("number"==k){if((-1*g.DV<=o)&&(o<g.DV)){this.fromInt(o)}else{this.fromString(o.toString(16),16)}}else{if("string"==k){this.fromString(o,10)}else{this.fromByteArray(o)}}}else{if(arguments.length==2){var o=arguments[0];var k=typeof o;var m=arguments[1];var j=typeof m;if("number"==k){this.fromNumber2(o,m)}else{if("string"==k){this.fromString(o,m)}else{throw"parameter(1) must be either a number or a string. "+k}}}else{if(arguments.length==3){var o=arguments[0];var k=typeof o;var m=arguments[1];var j=typeof m;var l=arguments[2];var i=typeof l;if("number"==k){this.fromNumber1(o,m,l)}else{throw"parameter(1) must be a number. "+k}}}}}};g.prototype.className="BigInteger";var a=new Array();var f=function(){var i,j;i="0".charCodeAt(0);for(j=0;j<=9;++j){a[i++]=j}i="a".charCodeAt(0);for(j=10;j<36;++j){a[i++]=j}i="A".charCodeAt(0);for(j=10;j<36;++j){a[i++]=j}};f();g.intAt=function(k,j){var l=a[k.charCodeAt(j)];return(l==null)?-1:l};var b="0123456789abcdefghijklmnopqrstuvwxyz";g.int2char=function(i){return b.charAt(i)};g.nbits=function(i){var k=1,j;if((j=i>>>16)!=0){i=j;k+=16}if((j=i>>8)!=0){i=j;k+=8}if((j=i>>4)!=0){i=j;k+=4}if((j=i>>2)!=0){i=j;k+=2}if((j=i>>1)!=0){i=j;k+=1}return k};g.prototype.copyTo=function(k){for(var j=this.t-1;j>=0;--j){k[j]=this[j]}k.t=this.t;k.s=this.s};g.prototype.fromInt=function(i){this.t=1;this.s=(i<0)?-1:0;if(i>0){this[0]=i}else{if(i<-1){this[0]=i+g.DV}else{this.t=0}}};g.prototype.fromString=function(r,l){var o;if(l<=0){throw"bitLength must be larger than 0"}else{if(l==2){o=1}else{if(l==4){o=2}else{if(l==8){o=3}else{if(l==16){o=4}else{if(l==32){o=5}else{if(l==256){o=8}else{this.fromRadix(r,l);return}}}}}}}this.t=0;this.s=0;var q=r.length;var m=false;var p=0;while(--q>=0){var j=(o==8)?r[q]&255:g.intAt(r,q);if(j<0){if(r.charAt(q)=="-"){m=true}continue}m=false;if(p==0){this[this.t++]=j}else{if(p+o>g.DB){this[this.t-1]|=(j&((1<<(g.DB-p))-1))<<p;this[this.t]=(j>>(g.DB-p));this.t++}else{this[this.t-1]|=j<<p}}p+=o;if(p>=g.DB){p-=g.DB}}if(o==8&&(r[0]&128)!=0){this.s=-1;if(p>0){this[this.t-1]|=((1<<(g.DB-p))-1)<<p}}this.clamp();if(m){g.ZERO.subTo(this,this)}};g.prototype.fromByteArray=function(i){return this.fromString(i,256)};g.prototype.clamp=function(){var i=this.s&g.DM;while(this.t>0&&this[this.t-1]==i){--this.t}};g.prototype.toString=function(l){if(this.s<0){return"-"+this.negate().toString(l)}var o;if(l==16){o=4}else{if(l==8){o=3}else{if(l==2){o=1}else{if(l==32){o=5}else{if(l==4){o=2}else{return this.toRadix(l)}}}}}var s=(1<<o)-1,v,j=false,t="",q=this.t;var u=g.DB-(q*g.DB)%o;if(q-->0){if(u<g.DB&&(v=this[q]>>u)>0){j=true;t=g.int2char(v)}while(q>=0){if(u<o){v=(this[q]&((1<<u)-1))<<(o-u);v|=this[--q]>>(u+=g.DB-o)}else{v=(this[q]>>(u-=o))&s;if(u<=0){u+=g.DB;--q}}if(v>0){j=true}if(j){t+=g.int2char(v)}}}return j?t:"0"};g.prototype.negate=function(){var i=new g();g.ZERO.subTo(this,i);return i};g.prototype.abs=function(){return(this.s<0)?this.negate():this};g.prototype.compareTo=function(j){var l=this.s-j.s;if(l!=0){return l}var k=this.t;l=k-j.t;if(l!=0){return l}while(--k>=0){if((l=this[k]-j[k])!=0){return l}}return 0};g.prototype.bitLength=function(){if(this.t<=0){return 0}return g.DB*(this.t-1)+g.nbits(this[this.t-1]^(this.s&g.DM))};g.prototype.dlShiftTo=function(l,k){var j;for(j=this.t-1;j>=0;--j){k[j+l]=this[j]}for(j=l-1;j>=0;--j){k[j]=0}k.t=this.t+l;k.s=this.s};g.prototype.drShiftTo=function(l,k){for(var j=l;j<this.t;++j){k[j-l]=this[j]}k.t=Math.max(this.t-l,0);k.s=this.s};g.prototype.lShiftTo=function(s,m){var k=s%g.DB;var j=g.DB-k;var p=(1<<j)-1;var o=Math.floor(s/g.DB),q=(this.s<<k)&g.DM,l;for(l=this.t-1;l>=0;--l){m[l+o+1]=(this[l]>>j)|q;q=(this[l]&p)<<k}for(l=o-1;l>=0;--l){m[l]=0}m[o]=q;m.t=this.t+o+1;m.s=this.s;m.clamp()};g.prototype.rShiftTo=function(q,m){m.s=this.s;var o=Math.floor(q/g.DB);if(o>=this.t){m.t=0;return}var k=q%g.DB;var j=g.DB-k;var p=(1<<k)-1;m[0]=this[o]>>k;for(var l=o+1;l<this.t;++l){m[l-o-1]|=(this[l]&p)<<j;m[l-o]=this[l]>>k}if(k>0){m[this.t-o-1]|=(this.s&p)<<j}m.t=this.t-o;m.clamp()};g.prototype.subTo=function(k,o){var l=0,p=0,j=Math.min(k.t,this.t);while(l<j){p+=this[l]-k[l];o[l++]=p&g.DM;p>>=g.DB}if(k.t<this.t){p-=k.s;while(l<this.t){p+=this[l];o[l++]=p&g.DM;p>>=g.DB}p+=this.s}else{p+=this.s;while(l<k.t){p-=k[l];o[l++]=p&g.DM;p>>=g.DB}p-=k.s}o.s=(p<0)?-1:0;if(p<-1){o[l++]=g.DV+p}else{if(p>0){o[l++]=p}}o.t=l;o.clamp()};g.prototype.multiplyTo=function(k,m){var j=this.abs(),o=k.abs();var l=j.t;m.t=l+o.t;while(--l>=0){m[l]=0}for(l=0;l<o.t;++l){m[l+j.t]=j.am(0,o[l],m,l,0,j.t)}m.s=0;m.clamp();if(this.s!=k.s){g.ZERO.subTo(m,m)}};g.prototype.squareTo=function(l){var j=this.abs();var k=l.t=2*j.t;while(--k>=0){l[k]=0}for(k=0;k<j.t-1;++k){var m=j.am(k,j[k],l,2*k,0,1);if((l[k+j.t]+=j.am(k+1,2*j[k],l,2*k+1,m,j.t-k-1))>=g.DV){l[k+j.t]-=g.DV;l[k+j.t+1]=1}}if(l.t>0){l[l.t-1]+=j.am(k,j[k],l,2*k,0,1)}l.s=0;l.clamp()};g.prototype.divRemTo=function(z,v,u){var F=z.abs();if(F.t<=0){return}var w=this.abs();if(w.t<F.t){if(v!=null){v.fromInt(0)}if(u!=null){this.copyTo(u)}return}if(u==null){u=new g()}var p=new g(),k=this.s,x=z.s;var E=g.DB-g.nbits(F[F.t-1]);if(E>0){F.lShiftTo(E,p);w.lShiftTo(E,u)}else{F.copyTo(p);w.copyTo(u)}var B=p.t;var l=p[B-1];if(l==0){return}var A=l*(1<<g.F1)+((B>1)?p[B-2]>>g.F2:0);var I=g.FV/A,H=(1<<g.F1)/A,G=1<<g.F2;var D=u.t,C=D-B,s=(v==null)?new g():v;p.dlShiftTo(C,s);if(u.compareTo(s)>=0){u[u.t++]=1;u.subTo(s,u)}g.ONE.dlShiftTo(B,s);s.subTo(p,p);while(p.t<B){p[p.t++]=0}while(--C>=0){var o=(u[--D]==l)?g.DM:Math.floor(u[D]*I+(u[D-1]+G)*H);if((u[D]+=p.am(0,o,u,C,0,B))<o){p.dlShiftTo(C,s);u.subTo(s,u);while(u[D]<--o){u.subTo(s,u)}}}if(v!=null){u.drShiftTo(B,v);if(k!=x){g.ZERO.subTo(v,v)}}u.t=B;u.clamp();if(E>0){u.rShiftTo(E,u)}if(k<0){g.ZERO.subTo(u,u)}};g.prototype.mod=function(i){var j=new g();this.abs().divRemTo(i,null,j);if(this.s<0&&j.compareTo(g.ZERO)>0){i.subTo(j,j)}return j};g.prototype.invDigit=function(){if(this.t<1){return 0}var i=this[0];if((i&1)==0){return 0}var j=i&3;j=(j*(2-(i&15)*j))&15;j=(j*(2-(i&255)*j))&255;j=(j*(2-(((i&65535)*j)&65535)))&65535;j=(j*(2-i*j%g.DV))%g.DV;return(j>0)?g.DV-j:-j};g.prototype.isEven=function(){return((this.t>0)?(this[0]&1):this.s)==0};g.prototype.exp=function(p,q){if(p>4294967295||p<1){return g.ONE}var o=new g(),j=new g(),m=q.convert(this),l=g.nbits(p)-1;m.copyTo(o);while(--l>=0){q.sqrTo(o,j);if((p&(1<<l))>0){q.mulTo(j,m,o)}else{var k=o;o=j;j=k}}return q.revert(o)};g.prototype.modPowInt=function(j,i){var k;if(j<256||i.isEven()){k=new g.Classic(i)}else{k=new g.Montgomery(i)}return this.exp(j,k)};g.log=function(i){return};g.err=function(i){return};g.ZERO=new g(0);g.ONE=new g(1);h(g);g.Classic=c;g.Montgomery=d;e.BigInteger=g})(window);(function(d){var b=function(f){return f};var a=function(){this.n=null;this.e=0;this.d=null;this.p=null;this.q=null;this.dmp1=null;this.dmq1=null;this.coeff=null;this.ksize=0;this.tolerantlyGenerate=true;this.preprocessPublic=b;this.preprocessPrivate=b;this.keyFormat=a.defaultKeyFormat;this.messageFormat=a.defaultMessageFormat};a.prototype.className="RSA";a.prototype.toString=function(h){if(h==null){h=16}var g=this;var f="n="+(g.n==null?"":g.n.toString(h)+"("+this.n.bitLength()+")")+"\ne="+(g.e==null?"":g.e.toString(h))+"\nd="+(g.d==null?"":g.d.toString(h)+"("+this.d.bitLength()+")")+"\np="+(g.p==null?"":g.p.toString(h))+"\nq="+(g.q==null?"":g.q.toString(h))+"\ndmp1="+(g.dmp1==null?"":g.dmp1.toString(h))+"\ndmq1="+(g.dmq1==null?"":g.dmq1.toString(h))+"\ncoeff="+(g.coeff==null?"":g.coeff.toString(h))+"\n";return f};function e(f){return function(){if(arguments.length==0){return this[f]}else{var h=arguments[0];var g=typeof h;if(h==null){throw"parameter "+f+" cannot be null."}else{if(g=="object"&&h.className=="BigInteger"){this[f]=h}else{if(g=="object"&&h.isArray){this[f]=new BigInteger(h)}else{if(g=="string"){this[f]=new BigInteger(h,16)}else{if(g=="number"){this[f]=new BigInteger(h)}else{throw"parameter "+f+" must be a BigInteger object or a hex string or a number object."}}}}}return this}}}function c(f){return function(){if(arguments.length==0){return this[f]}else{var h=arguments[0];var g=typeof h;if(h==null){throw"parameter "+f+" cannot be null."}else{if(g=="object"&&h.className=="BigInteger"){this[f]=h.intValue()}else{if(g=="object"&&h.isArray){this[f]=new BigInteger(h).intValue()}else{if(g=="string"){this[f]=parseInt(h,16)}else{if(g=="number"){this[f]=h}else{throw"parameter "+f+" must be a BigInteger object or a hex string or a number object."}}}}}return this}}}a.prototype._n=e("n");a.prototype._e=c("e");a.prototype._d=e("d");a.prototype._p=e("p");a.prototype._q=e("q");a.prototype._dmp1=e("dmp1");a.prototype._dmq1=e("dmq1");a.prototype._coeff=e("coeff");a.prototype._ksize=c("ksize");a.log=function(f){};a.err=function(f){};d.RSA=a})(window);(function(e){var b=function(){this.i=0;this.j=0;this.S=new Array()};b.prototype.init=function(m){var l,h,k;for(l=0;l<256;++l){this.S[l]=l}h=0;for(l=0;l<256;++l){h=(h+this.S[l]+m[l%m.length])&255;k=this.S[l];this.S[l]=this.S[h];this.S[h]=k}this.i=0;this.j=0};b.prototype.next=function(){var h;this.i=(this.i+1)&255;this.j=(this.j+this.S[this.i])&255;h=this.S[this.i];this.S[this.i]=this.S[this.j];this.S[this.j]=h;return this.S[(h+this.S[this.i])&255]};b.create=function(){return new b()};b.rng_psize=256;var g=null;var d=[];var c=0;rng_seed_int=function(h){d[c]^=h&255;c++;d[c]^=(h>>8)&255;c++;d[c]^=(h>>16)&255;c++;d[c]^=(h>>24)&255;c++;if(c>=b.rng_psize){c-=b.rng_psize}};rng_seed_time=function(){rng_seed_int(new Date().getTime())};pool_init=function(){var h;if(navigator.appName=="Netscape"&&navigator.appVersion<"5"&&e.crypto){var i=e.crypto.random(32);for(h=0;h<i.length;++h){d[c++]=i.charCodeAt(h)&255}}while(c<b.rng_psize){h=Math.floor(65536*Math.random());d[c++]=h>>>8;d[c++]=h&255}c=0;rng_seed_time()};var f=function(){if(g==null){rng_seed_time();g=b.create();g.init(d);for(c=0;c<d.length;++c){d[c]=0}c=0}return g.next()};var a=function(){};a.prototype.nextBytes=function(j){for(var h=0;h<j.length;++h){j[h]=f()}};pool_init();e.SecureRandom=a})(window);(function(){BigInteger.prototype.clone=function(){var f=new BigInteger();this.copyTo(f);return f};BigInteger.prototype.intValue=function(){if(this.s<0){if(this.t==1){return this[0]-BigInteger.DV}else{if(this.t==0){return -1}}}else{if(this.t==1){return this[0]}else{if(this.t==0){return 0}}}return((this[1]&((1<<(32-BigInteger.DB))-1))<<BigInteger.DB)|this[0]};BigInteger.prototype.byteValue=function(){return(this.t==0)?this.s:(this[0]<<24)>>24};BigInteger.prototype.shortValue=function(){return(this.t==0)?this.s:(this[0]<<16)>>16};BigInteger.prototype.chunkSize=function(f){return Math.floor(Math.LN2*BigInteger.DB/Math.log(f))};BigInteger.prototype.signum=function(){if(this.s<0){return -1}else{if(this.t<=0||(this.t==1&&this[0]<=0)){return 0}else{return 1}}};BigInteger.prototype.toRadix=function(f){if(f==null){f=10}if(this.signum()==0||f<2||f>36){return"0"}var h=this.chunkSize(f);var g=Math.pow(f,h);var k=new BigInteger(g),l=new BigInteger(),j=new BigInteger(),i="";this.divRemTo(k,l,j);while(l.signum()>0){i=(g+j.intValue()).toString(f).substr(1)+i;l.divRemTo(k,l,j)}return j.intValue().toString(f)+i};BigInteger.prototype.fromRadix=function(q,m){this.fromInt(0);if(m==null){m=10}var k=this.chunkSize(m);var l=Math.pow(m,k);var h=false;var f=0;var p=0;for(var g=0;g<q.length;++g){var o=BigInteger.intAt(q,g);if(o<0){if(q.charAt(g)=="-"&&this.signum()==0){h=true}continue}p=m*p+o;if(++f>=k){this.dMultiply(l);this.dAddOffset(p,0);f=0;p=0}}if(f>0){this.dMultiply(Math.pow(m,f));this.dAddOffset(p,0)}if(h){BigInteger.ZERO.subTo(this,this)}};var e=0;BigInteger.prototype.fromNumber1=function(g,h,f){if(g<2){this.fromInt(1)}else{this.fromNumber2(g,f);if(!this.testBit(g-1)){this.bitwiseTo(BigInteger.ONE.shiftLeft(g-1),BigInteger.op_or,this)}if(this.isEven()){this.dAddOffset(1,0)}while(!this.isProbablePrime(h)){this.dAddOffset(2,0);if(this.bitLength()>g){this.subTo(BigInteger.ONE.shiftLeft(g-1),this)}}}};BigInteger.prototype.fromNumber2=function(i,h){var f=new Array();var g=i&7;f.length=(i>>3)+1;h.nextBytes(f);if(g>0){f[0]&=((1<<g)-1)}else{f[0]=0}this.fromString(f,256)};BigInteger.prototype.toByteArray=function(){var h=this.t;var j=new Array();j[0]=this.s;var l=BigInteger.DB-(h*BigInteger.DB)%8;var m;var g=0;if(h-->0){if(l<BigInteger.DB&&(m=this[h]>>l)!=(this.s&BigInteger.DM)>>l){j[g++]=m|(this.s<<(BigInteger.DB-l))}while(h>=0){if(l<8){m=(this[h]&((1<<l)-1))<<(8-l);m|=this[--h]>>(l+=BigInteger.DB-8)}else{m=(this[h]>>(l-=8))&255;if(l<=0){l+=BigInteger.DB;--h}}if((m&128)!=0){m|=-256}if(g==0&&(this.s&128)!=(m&128)){++g}if(g>0||m!=this.s){j[g++]=m}}}for(var f=0;f<j.length;f++){j[f]=255&j[f]}return j};BigInteger.prototype.equals=function(f){return(this.compareTo(f)==0)};BigInteger.prototype.min=function(f){return(this.compareTo(f)<0)?this:f};BigInteger.prototype.max=function(f){return(this.compareTo(f)>0)?this:f};BigInteger.prototype.bitwiseTo=function(h,o,k){var j,l,g=Math.min(h.t,this.t);for(j=0;j<g;++j){k[j]=o(this[j],h[j])}if(h.t<this.t){l=h.s&BigInteger.DM;for(j=g;j<this.t;++j){k[j]=o(this[j],l)}k.t=this.t}else{l=this.s&BigInteger.DM;for(j=g;j<h.t;++j){k[j]=o(l,h[j])}k.t=h.t}k.s=o(this.s,h.s);k.clamp()};BigInteger.op_and=function(f,g){return f&g};BigInteger.prototype.ope_and=function(f){var g=new BigInteger();this.bitwiseTo(f,BigInteger.op_and,g);return g};BigInteger.prototype.and=BigInteger.prototype.ope_and;BigInteger.op_or=function(f,g){return f|g};BigInteger.prototype.ope_or=function(f){var g=new BigInteger();this.bitwiseTo(f,BigInteger.op_or,g);return g};BigInteger.prototype.or=BigInteger.prototype.ope_or;BigInteger.op_xor=function(f,g){return f^g};BigInteger.prototype.ope_xor=function(f){var g=new BigInteger();this.bitwiseTo(f,BigInteger.op_xor,g);return g};BigInteger.prototype.xor=BigInteger.prototype.ope_xor;BigInteger.op_andnot=function(f,g){return f&~g};BigInteger.prototype.ope_andNot=function(f){var g=new BigInteger();this.bitwiseTo(f,BigInteger.op_andnot,g);return g};BigInteger.prototype.andNot=BigInteger.prototype.ope_andNot;BigInteger.prototype.ope_not=function(){var g=new BigInteger();for(var f=0;f<this.t;++f){g[f]=BigInteger.DM&~this[f]}g.t=this.t;g.s=~this.s;return g};BigInteger.prototype.not=BigInteger.prototype.ope_not;BigInteger.prototype.shiftLeft=function(g){var f=new BigInteger();if(g<0){this.rShiftTo(-g,f)}else{this.lShiftTo(g,f)}return f};BigInteger.prototype.shiftRight=function(g){var f=new BigInteger();if(g<0){this.lShiftTo(-g,f)}else{this.rShiftTo(g,f)}return f};BigInteger.lbit=function(f){if(f==0){return -1}var g=0;if((f&65535)==0){f>>=16;g+=16}if((f&255)==0){f>>=8;g+=8}if((f&15)==0){f>>=4;g+=4}if((f&3)==0){f>>=2;g+=2}if((f&1)==0){++g}return g};BigInteger.prototype.getLowestSetBit=function(){for(var f=0;f<this.t;++f){if(this[f]!=0){return f*BigInteger.DB+BigInteger.lbit(this[f])}}if(this.s<0){return this.t*BigInteger.DB}return -1};BigInteger.cbit=function(f){var g=0;while(f!=0){f&=f-1;++g}return g};BigInteger.prototype.bitCount=function(){var h=0,f=this.s&BigInteger.DM;for(var g=0;g<this.t;++g){h+=BigInteger.cbit(this[g]^f)}return h};BigInteger.prototype.testBit=function(g){var f=Math.floor(g/BigInteger.DB);if(f>=this.t){return(this.s!=0)}return((this[f]&(1<<(g%BigInteger.DB)))!=0)};BigInteger.prototype.changeBit=function(h,g){var f=BigInteger.ONE.shiftLeft(h);this.bitwiseTo(f,g,f);return f};BigInteger.prototype.setBit=function(f){return this.changeBit(f,BigInteger.op_or)};BigInteger.prototype.clearBit=function(f){return this.changeBit(f,BigInteger.op_andnot)};BigInteger.prototype.flipBit=function(f){return this.changeBit(f,BigInteger.op_xor)};BigInteger.prototype.addTo=function(g,j){var h=0,k=0,f=Math.min(g.t,this.t);while(h<f){k+=this[h]+g[h];j[h++]=k&BigInteger.DM;k>>=BigInteger.DB}if(g.t<this.t){k+=g.s;while(h<this.t){k+=this[h];j[h++]=k&BigInteger.DM;k>>=BigInteger.DB}k+=this.s}else{k+=this.s;while(h<g.t){k+=g[h];j[h++]=k&BigInteger.DM;k>>=BigInteger.DB}k+=g.s}j.s=(k<0)?-1:0;if(k>0){j[h++]=k}else{if(k<-1){j[h++]=BigInteger.DV+k}}j.t=h;j.clamp()};BigInteger.prototype.ope_add=function(f){var g=new BigInteger();this.addTo(f,g);return g};BigInteger.prototype.add=BigInteger.prototype.ope_add;BigInteger.prototype.ope_subtract=function(f){var g=new BigInteger();this.subTo(f,g);return g};BigInteger.prototype.subtract=BigInteger.prototype.ope_subtract;BigInteger.prototype.ope_multiply=function(f){var g=new BigInteger();this.multiplyTo(f,g);return g};BigInteger.prototype.multiply=BigInteger.prototype.ope_multiply;BigInteger.prototype.ope_divide=function(f){var g=new BigInteger();this.divRemTo(f,g,null);return g};BigInteger.prototype.divide=BigInteger.prototype.ope_divide;BigInteger.prototype.ope_remainder=function(f){var g=new BigInteger();this.divRemTo(f,null,g);return g};BigInteger.prototype.remainder=BigInteger.prototype.ope_remainder;BigInteger.prototype.ope_divideAndRemainder=function(f){var h=new BigInteger(),g=new BigInteger();this.divRemTo(f,h,g);return new Array(h,g)};BigInteger.prototype.divideAndRemainder=BigInteger.prototype.ope_divideAndRemainder;BigInteger.prototype.dMultiply=function(f){this[this.t]=this.am(0,f-1,this,0,0,this.t);++this.t;this.clamp()};BigInteger.prototype.dAddOffset=function(g,f){while(this.t<=f){this[this.t++]=0}this[f]+=g;while(this[f]>=BigInteger.DV){this[f]-=BigInteger.DV;if(++f>=this.t){this[this.t++]=0}++this[f]}};var c=function(){this.convert=function(f){return f};this.revert=function(f){return f};this.mulTo=function(f,h,g){f.multiplyTo(h,g)};this.sqrTo=function(f,g){f.squareTo(g)}};BigInteger.prototype.ope_pow=function(f){return this.exp(f,new BigInteger.NullExp())};BigInteger.prototype.pow=BigInteger.prototype.ope_pow;BigInteger.prototype.multiplyLowerTo=function(f,l,k){var h=Math.min(this.t+f.t,l);k.s=0;k.t=h;while(h>0){k[--h]=0}var g;for(g=k.t-this.t;h<g;++h){k[h+this.t]=this.am(0,f[h],k,h,0,this.t)}for(g=Math.min(f.t,l);h<g;++h){this.am(0,f[h],k,h,0,l-h)}k.clamp()};BigInteger.prototype.multiplyUpperTo=function(f,j,h){--j;var g=h.t=this.t+f.t-j;h.s=0;while(--g>=0){h[g]=0}for(g=Math.max(j-this.t,0);g<f.t;++g){h[this.t+g-j]=this.am(j-g,f[g],h,0,0,this.t+g-j)}h.clamp();h.drShiftTo(1,h)};var a=function(f){this.r2=new BigInteger();this.q3=new BigInteger();BigInteger.ONE.dlShiftTo(2*f.t,this.r2);this.mu=this.r2.divide(f);this.m=f;this.concert=function(g){if(g.s<0||g.t>2*this.m.t){return g.mod(this.m)}else{if(g.compareTo(this.m)<0){return g}else{var h=new BigInteger();g.copyTo(h);this.reduce(h);return h}}};this.revert=function(g){return g};this.reduce=function(g){g.drShiftTo(this.m.t-1,this.r2);if(g.t>this.m.t+1){g.t=this.m.t+1;g.clamp()}this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);while(g.compareTo(this.r2)<0){g.dAddOffset(1,this.m.t+1)}g.subTo(this.r2,g);while(g.compareTo(this.m)>=0){g.subTo(this.m,g)}};this.sqrTo=function(g,h){g.squareTo(h);this.reduce(h)};this.mulTo=function(g,i,h){g.multiplyTo(i,h);this.reduce(h)}};BigInteger.Barrett=a;BigInteger.prototype.modPow=function(x,p){var u=x.bitLength(),q,h=new BigInteger(1),B;if(u<=0){return h}else{if(u<18){q=1}else{if(u<48){q=3}else{if(u<144){q=4}else{if(u<768){q=5}else{q=6}}}}}if(u<8){B=new BigInteger.Classic(p)}else{if(p.isEven()){B=new BigInteger.Barrett(p)}else{B=new BigInteger.Montgomery(p)}}var v=new Array(),o=3,y=q-1,f=(1<<q)-1;v[1]=B.convert(this);if(q>1){var E=new BigInteger();B.sqrTo(v[1],E);while(o<=f){v[o]=new BigInteger();B.mulTo(E,v[o-2],v[o]);o+=2}}var s=x.t-1,C,A=true,l=new BigInteger(),D;u=BigInteger.nbits(x[s])-1;while(s>=0){if(u>=y){C=(x[s]>>(u-y))&f}else{C=(x[s]&((1<<(u+1))-1))<<(y-u);if(s>0){C|=x[s-1]>>(BigInteger.DB+u-y)}}o=q;while((C&1)==0){C>>=1;--o}if((u-=o)<0){u+=BigInteger.DB;--s}if(A){v[C].copyTo(h);A=false}else{while(o>1){B.sqrTo(h,l);B.sqrTo(l,h);o-=2}if(o>0){B.sqrTo(h,l)}else{D=h;h=l;l=D}B.mulTo(l,v[C],h)}while(s>=0&&(x[s]&(1<<u))==0){B.sqrTo(h,l);D=h;h=l;l=D;if(--u<0){u=BigInteger.DB-1;--s}}}return B.revert(h)};BigInteger.prototype.gcd=function(h){var f=(this.s<0)?this.negate():this.clone();var m=(h.s<0)?h.negate():h.clone();if(f.compareTo(m)<0){var k=f;f=m;m=k}var j=f.getLowestSetBit(),l=m.getLowestSetBit();if(l<0){return f}if(j<l){l=j}if(l>0){f.rShiftTo(l,f);m.rShiftTo(l,m)}while(f.signum()>0){if((j=f.getLowestSetBit())>0){f.rShiftTo(j,f)}if((j=m.getLowestSetBit())>0){m.rShiftTo(j,m)}if(f.compareTo(m)>=0){f.subTo(m,f);f.rShiftTo(1,f)}else{m.subTo(f,m);m.rShiftTo(1,m)}}if(l>0){m.lShiftTo(l,m)}return m};BigInteger.prototype.modInt=function(j){if(j<=0){return 0}var h=BigInteger.DV%j,g=(this.s<0)?j-1:0;if(this.t>0){if(h==0){g=this[0]%j}else{for(var f=this.t-1;f>=0;--f){g=(h*g+this[f])%j}}}return g};BigInteger.prototype.modInverse=function(g){var k=g.isEven();if((this.isEven()&&k)||g.signum()==0){return BigInteger.ZERO}var j=g.clone(),i=this.clone();var h=new BigInteger(1),f=new BigInteger(0),o=new BigInteger(0),l=new BigInteger(1);while(j.signum()!=0){while(j.isEven()){j.rShiftTo(1,j);if(k){if(!h.isEven()||!f.isEven()){h.addTo(this,h);f.subTo(g,f)}h.rShiftTo(1,h)}else{if(!f.isEven()){f.subTo(g,f)}}f.rShiftTo(1,f)}while(i.isEven()){i.rShiftTo(1,i);if(k){if(!o.isEven()||!l.isEven()){o.addTo(this,o);l.subTo(g,l)}o.rShiftTo(1,o)}else{if(!l.isEven()){l.subTo(g,l)}}l.rShiftTo(1,l)}if(j.compareTo(i)>=0){j.subTo(i,j);if(k){h.subTo(o,h)}f.subTo(l,f)}else{i.subTo(j,i);if(k){o.subTo(h,o)}l.subTo(f,l)}}if(i.compareTo(BigInteger.ONE)!=0){return BigInteger.ZERO}if(l.compareTo(g)>=0){return l.subtract(g)}if(l.signum()<0){l.addTo(g,l)}else{return l}if(l.signum()<0){return l.ope_add(g)}else{return l}};var d=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509];var b=(1<<26)/d[d.length-1];BigInteger.lowprimes=d;BigInteger.lplim=b;BigInteger.prototype.isProbablePrime=function(o){var l,h=this.abs();if(h.t==1&&h[0]<=d[d.length-1]){for(l=0;l<d.length;++l){if(h[0]==d[l]){return true}}return false}if(h.isEven()){return false}l=1;while(l<d.length){var g=d[l];var k=l+1;while(k<d.length&&g<b){g*=d[k++]}g=h.modInt(g);while(l<k){if(g%d[l++]==0){return false}}}var f=h.millerRabin(o);return f};BigInteger.prototype.millerRabin=function(m){var o=this.subtract(BigInteger.ONE);var g=o.getLowestSetBit();if(g<=0){return false}var p=o.shiftRight(g);m=(m+1)>>1;if(m>d.length){m=d.length}var f=new BigInteger();for(var l=0;l<m;++l){f.fromInt(d[l]);var q=f.modPow(p,this);if(q.compareTo(BigInteger.ONE)!=0&&q.compareTo(o)!=0){var h=1;while(h++<g&&q.compareTo(o)!=0){q=q.modPowInt(2,this);if(q.compareTo(BigInteger.ONE)==0){return false}}if(q.compareTo(o)!=0){return false}}}return true};BigInteger.NullExp=c})();(function(){RSA.prototype.privateKey=function(f,b,c,a){if(arguments.length==0){return{n:this.n,e:this.e,d:this.d,ksize:this.ksize}}else{this._n(f);this._e(b);this._d(c);this._ksize(a)}};RSA.prototype.key=function(j,g,h,f,c,i,a,b){if(arguments.length==0){return{n:this.n,e:this.e,d:this.d,p:this.p,q:this.q,dmp1:this.dmp1,dmq1:this.dmq1,coeff:this.coeff}}else{this._n(j);this._e(g);this._d(h);this._p(f);this._q(c);this._dmp1(i);this._dmq1(a);this._coeff(b)}};RSA.prototype.splitBitLength=function(b){if(this.tolerantlyGenerate){var a=b>>1;return[b-a+1,a+1]}else{trace("strict1");var a=b>>1;return[b-a,a]}};RSA.prototype.isProperBitLength=function(a,b){if(this.tolerantlyGenerate){return true}else{trace("strict2");return b==a.bitLength()}};RSA.prototype.generate=function(b,j){var a=new SecureRandom();var g=this.splitBitLength(b);this._e(j);var d=new BigInteger(this.e);for(;;){for(;;){this.p=new BigInteger(g[0],1,a);if(this.p.subtract(BigInteger.ONE).gcd(d).compareTo(BigInteger.ONE)==0&&this.p.isProbablePrime(10)){break}}for(;;){this.q=new BigInteger(g[1],1,a);if(this.q.subtract(BigInteger.ONE).gcd(d).compareTo(BigInteger.ONE)==0&&this.q.isProbablePrime(10)){break}}var c=this.p.compareTo(this.q);if(c==0){continue}else{if(c<0){var i=this.p;this.p=this.q;this.q=i}}var h=this.p.subtract(BigInteger.ONE);var e=this.q.subtract(BigInteger.ONE);var f=h.multiply(e);if(f.gcd(d).compareTo(BigInteger.ONE)==0){this.n=this.p.multiply(this.q);if(!this.isProperBitLength(this.n,b)){continue}this.d=d.modInverse(f);this.dmp1=this.d.mod(h);this.dmq1=this.d.mod(e);this.coeff=this.q.modInverse(this.p);break}}this._ksize(b)};RSA.prototype.processPrivate=function(b){b=this.preprocessPrivate(b);if(this.p==null||this.q==null){return b.modPow(this.d,this.n)}else{var c=b.mod(this.p).modPow(this.dmp1,this.p);var a=b.mod(this.q).modPow(this.dmq1,this.q);while(c.compareTo(a)<0){c=c.ope_add(this.p)}return c.subtract(a).multiply(this.coeff).mod(this.p).multiply(this.q).ope_add(a)}};RSA.prototype.privateEncrypt=function(a){if(this.messageFormat==null){throw"Error. No message format is installed."}return this.messageFormat.privateEncrypt(this,a)};RSA.prototype.privateDecrypt=function(a){if(this.messageFormat==null){throw"Error. No message format is installed."}return this.messageFormat.privateDecrypt(this,a)};RSA.prototype.privateEncryptMaxSize=function(){if(this.messageFormat==null){throw"Error. No message format is installed."}return this.messageFormat.privateEncryptMaxSize(this)};RSA.prototype.privateKeyBytes=function(){if(this.keyFormat==null){throw"Error. No key format is installed."}if(arguments.length==0){if(this.ksize==null||this.ksize==0){throw"key size is not set."}return this.keyFormat.encodePrivateKey(this.n,this.e,this.d,this.ksize)}else{var a=this.keyFormat.decodePrivateKey(arguments[0]);this.privateKey(a.n,a.e,a.d,a.ksize);return this}}})();(function(){var b=BigInteger.lowprimes;var a=BigInteger.lplim;BigInteger.prototype.stepping_fromNumber1=function(f,g,d){var c=this;BigInteger.log("stepping_fromNumber1");var e={toString:function(){return"*** FAILED TO RETRIEVE RESULT ***"}};return STEP(function(){BigInteger.log("stepping_fromNumber1.1");if(f<2){c.fromInt(1);return}else{c.fromNumber2(f,d);if(!c.testBit(f-1)){c.bitwiseTo(BigInteger.ONE.shiftLeft(f-1),BigInteger.op_or,c)}if(c.isEven()){c.dAddOffset(1,0)}BigInteger.log("stepping_fromNumber1.2");return DO([function(){SET(e);BigInteger.log("stepping_fromNumber1.2.1.1: calling stepping_isProbablePrime");return c.stepping_isProbablePrime(g)},function(h){BigInteger.log("stepping_fromNumber1.2.1.2: returned stepping_isProbablePrime:"+h);if(h==null||h==e){BigInteger.err("stepping_fromNumber1.2.1.2: returned stepping_isProbablePrime: subparam.result == WARNING NULL "+h)}if(h){return DONE()}},function(){BigInteger.log("stepping_fromNumber1.2.2");c.dAddOffset(2,0);if(c.bitLength()>f){c.subTo(BigInteger.ONE.shiftLeft(f-1),c)}}])}})};BigInteger.prototype.stepping_isProbablePrime=function(e){var d=this;var c=d.abs();return DO([function(){BigInteger.log("stepping_isProbablePrime No.1: ");var h;if(c.t==1&&c[0]<=b[b.length-1]){for(h=0;h<b.length;++h){if(c[0]==b[h]){BigInteger.log("stepping_isProbablePrime.1 EXIT");return DONE(true)}}BigInteger.log("stepping_isProbablePrime.2 EXIT");return DONE(false)}if(c.isEven()){BigInteger.log("stepping_isProbablePrime.3 EXIT");return DONE(false)}h=1;while(h<b.length){var f=b[h];var g=h+1;while(g<b.length&&f<a){f*=b[g++]}f=c.modInt(f);while(h<g){if(f%b[h++]==0){BigInteger.log("stepping_isProbablePrime:4 EXIT");return DONE(false)}}}BigInteger.log("stepping_isProbablePrime:5 BREAK")},function(f){BigInteger.log("stepping_isProbablePrime No.2: calling millerRabin : subparam.result="+f);SET(null);return c.stepping_millerRabin(e)},function(f){BigInteger.log("stepping_isProbablePrime No.3: returning millerRabin : subparam.result="+f);BigInteger.log("stepping_isProbablePrime No.3: param.result="+f);return DONE()}])};BigInteger.prototype.stepping_millerRabin=function(g){var e=this;var h;var d;var j;var c;var f=0;var l;return DO([function(){h=e.subtract(BigInteger.ONE);d=h.getLowestSetBit();if(d<=0){return DONE(false)}j=h.shiftRight(d);g=(g+1)>>1;if(g>b.length){g=b.length}c=new BigInteger()},[function(){if(f<g){return}else{return DONE(true)}},function(){BigInteger.log("stepping_millerRabin:No2.2");c.fromInt(b[f])},function(){return c.stepping_modPow(j,e)},function(i){l=i},function(){if(l.compareTo(BigInteger.ONE)!=0&&l.compareTo(h)!=0){var i=1;while(i++<d&&l.compareTo(h)!=0){l=l.modPowInt(2,e);if(l.compareTo(BigInteger.ONE)==0){return DONE(false)}}if(l.compareTo(h)!=0){return DONE(false)}}},function(){++f}],function(){return DONE()}])};BigInteger.prototype.stepping_modPow=function(q,f){var y=this;var o,h,c,u;var p;var l,v,s,d,x;return DO([function(){o=q.bitLength();c=new BigInteger(1);if(o<=0){return DONE(c)}else{if(o<18){h=1}else{if(o<48){h=3}else{if(o<144){h=4}else{if(o<768){h=5}else{h=6}}}}}if(o<8){u=new BigInteger.Classic(f)}else{if(f.isEven()){u=new BigInteger.Barrett(f)}else{u=new BigInteger.Montgomery(f)}}p=new Array(),n=3,k1=h-1,km=(1<<h)-1;p[1]=u.convert(y);if(h>1){var e=new BigInteger();u.sqrTo(p[1],e);while(n<=km){p[n]=new BigInteger();u.mulTo(e,p[n-2],p[n]);n+=2}}l=q.t-1;s=true;d=new BigInteger();o=BigInteger.nbits(q[l])-1},function(){if(l>=0){if(o>=k1){v=(q[l]>>(o-k1))&km}else{v=(q[l]&((1<<(o+1))-1))<<(k1-o);if(l>0){v|=q[l-1]>>(BigInteger.DB+o-k1)}}n=h;while((v&1)==0){v>>=1;--n}if((o-=n)<0){o+=BigInteger.DB;--l}if(s){p[v].copyTo(c);s=false}else{while(n>1){u.sqrTo(c,d);u.sqrTo(d,c);n-=2}if(n>0){u.sqrTo(c,d)}else{x=c;c=d;d=x}u.mulTo(d,p[v],c)}while(l>=0&&(q[l]&(1<<o))==0){u.sqrTo(c,d);x=c;c=d;d=x;if(--o<0){o=BigInteger.DB-1;--l}}return CONTINUE()}else{return}},function(){var e=u.revert(c);return DONE(e)}])};BigInteger.prototype.exp=function(k,l){if(k>4294967295||k<1){return BigInteger.ONE}var j=new BigInteger(),c=new BigInteger(),h=l.convert(this),f=BigInteger.nbits(k)-1;h.copyTo(j);while(--f>=0){l.sqrTo(j,c);if((k&(1<<f))>0){l.mulTo(c,h,j)}else{var d=j;j=c;c=d}}return l.revert(j)};BigInteger.prototype.modPowInt=function(d,c){var f;if(d<256||c.isEven()){f=new BigInteger.Classic(c)}else{f=new BigInteger.Montgomery(c)}return this.exp(d,f)}})();(function(){RSA.prototype.generateAsync=function(e,g,a){var b=this;var f=new NS(c,true);var d=function(h){a(b)};f.EXEC([e,g],d);function c(p){var i,q;i=p[0];q=p[1];var h;var m=b.splitBitLength(i);b._e(q);var j=new BigInteger(b.e);var o;var k;var l;return DO([function(){RSA.log("RSAEngine:1.1");b.p=new BigInteger();h=new SecureRandom()},function(){RSA.log("RSAEngine:1.2");return b.p.stepping_fromNumber1(m[0],1,h)},[function(){RSA.log("RSAEngine:1.3.1");if(b.p.subtract(BigInteger.ONE).gcd(j).compareTo(BigInteger.ONE)!=0){return AGAIN()}},function(){RSA.log("RSAEngine:1.3.2 : calling stepping_isProbablePrime");return b.p.stepping_isProbablePrime(10)},function(r){RSA.log("RSAEngine:1.3.3 : returned stepping_isProbablePrime"+r);if(r){RSA.log("RSAEngine:1.3.3=>EXIT");return DONE()}else{RSA.log("RSAEngine:1.3.3=>AGAIN");return AGAIN()}},EXIT],function(){RSA.log("RSAEngine:2.0")},[function(){RSA.log("RSAEngine:2.1");b.q=new BigInteger()},function(){RSA.log("RSAEngine:2.2");return b.q.stepping_fromNumber1(m[1],1,h)},function(){var r=b.q.subtract(BigInteger.ONE).gcd(j).compareTo(BigInteger.ONE);RSA.log("RSAEngine:2.3.1 returned from q.stepping_from number with result "+r);if(r!=0){return AGAIN()}},function(){RSA.log("RSAEngine:2.3.2");return b.q.stepping_isProbablePrime(10)},function(r){RSA.log("RSAEngine:2.3.3:result="+r);if(r){RSA.log("RSAEngine:2.3.3=>EXIT");return DONE()}else{RSA.log("RSAEngine:2.3.3=>AGAIN");return AGAIN()}},EXIT],function(){RSA.log("RSAEngine:2.3");if(b.p.compareTo(b.q)<=0){var r=b.p;b.p=b.q;b.q=r}RSA.log("RSAEngine:3.1");RSA.log("p="+b.p.toString(16));RSA.log("q="+b.q.toString(16))},function(){RSA.log("RSAEngine:3.2");o=b.p.subtract(BigInteger.ONE);k=b.q.subtract(BigInteger.ONE);l=o.multiply(k);if(l.gcd(j).compareTo(BigInteger.ONE)==0){RSA.log("RSAEngine:3.2=>BREAK");return}else{RSA.log("RSAEngine:3.2=>AGAIN");return AGAIN()}},function(){RSA.log("RSAEngine:3.2.sub");if(b.p.compareTo(b.q)==0){RSA.log("RSAEngine:3.2.sub +++ P & Q ARE EQUAL !!!");return AGAIN()}b.n=b.p.multiply(b.q);if(!b.isProperBitLength(b.n,i)){RSA.log("RSAEngine:3.3.2.1:AGAIN bitLength="+b.n.bitLength()+" B="+i);return AGAIN()}},function(){RSA.log("RSAEngine:3.3.1");RSA.log("RSAEngine:3.3.1(1)");b.d=j.modInverse(l);RSA.log("RSAEngine:3.3.2(2)");b._ksize(i)},function(){RSA.log("RSAEngine:3.3.2");b.dmp1=b.d.mod(o);b.dmq1=b.d.mod(k)},function(){RSA.log("RSAEngine:3.3.3");b.coeff=b.q.modInverse(b.p)},EXIT])}}})();